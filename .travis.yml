language: node_js
node_js:
  - "node"
cache:
  directories:
    - "node_modules"
jobs:
  include:
    - stage: "Test"
      script:
      - echo "Testing"
      - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
      - docker build -t $DOCKER_USERNAME/express-boilerplate-test -f Dockerfile.test .
      - docker run --rm 
    - stage: "Build"
      script:
      - echo "Building"
      # - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
      # - docker build -t $DOCKER_USERNAME/express-boilerplate .
      # - docker images
      # - docker tag $DOCKER_USERNAME/express-boilerplate $DOCKER_USERNAME/express-boilerplate
      # - docker push $DOCKER_USERNAME/express-boilerplate
    
    - stage: "Publish"
      script:
      - echo "Publishing"